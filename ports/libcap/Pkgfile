# Description: POSIX.1e capabilities library
# URL:         http://sites.google.com/site/fullycapable/
# Maintainer:  CRUX System Team, core-ports at crux dot nu
# Depends on:  attr linux-pam

name=libcap
version=2.29
release=mix-2
source=(https://www.kernel.org/pub/linux/libs/security/linux-privs/libcap2/$name-$version.tar.xz
        libcap-2.29-libpsx_pkgconfig.patch)

build () {
    cd $name-$version

    patch -p1 -i $SRC/libcap-2.29-libpsx_pkgconfig.patch
    sed -i "/^CFLAGS/s/-O2/$CFLAGS/" Make.Rules 

    make GOLANG=no RAISE_SETFCAP=no DESTDIR=$PKG install

    install -d $PKG/usr/lib
    mv $PKG/lib*/libcap.a $PKG/usr/lib
    rm $PKG/lib*/libcap.so
    ln -s ../../lib/libcap.so.$version $PKG/usr/lib/libcap.so
}
