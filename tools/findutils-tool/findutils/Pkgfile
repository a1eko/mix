# Description: file searching utilities

name=findutils
version=4.6.0
release=0
source=(ftp://ftp.gnu.org/gnu/findutils/findutils-$version.tar.gz)

build() {
  cd $name-$version

  # fixes for glibc 2.28
  sed -i 's/IO_ftrylockfile/IO_EOF_SEEN/' gl/lib/*.c
  sed -i '/unistd/a #include <sys/sysmacros.h>' gl/lib/mountlist.c
  echo "#define _IO_IN_BACKUP 0x100" >> gl/lib/stdio-impl.h

  ./configure --prefix=/tools
  make
  make DESTDIR=$PKG install
  rm -rv $PKG/tools/share/{info,man}
}
