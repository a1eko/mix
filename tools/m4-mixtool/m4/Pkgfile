# Description: macro processor

name=m4
version=1.4.18
release=0
source=(http://ftp.gnu.org/gnu/m4/m4-$version.tar.xz)

build() {
  cd $name-$version

  # fixes for glibc 2.28+
  sed -i 's/IO_ftrylockfile/IO_EOF_SEEN/' lib/*.c
  echo "#define _IO_IN_BACKUP 0x100" >> lib/stdio-impl.h

  ./configure --prefix=/usr \
     --host=$MIX_TGT \
     --build=$(build-aux/config.guess)
  make
  make DESTDIR=$PKG install
  rm -rv $PKG/usr/share/{info,man}
}
