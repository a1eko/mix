# Description: state-dependent file processing

name=make
version=4.4
release=0
source=(http://ftp.gnu.org/gnu/make/make-$version.tar.gz)

build() {
  cd $name-$version

  # fix an issue identified upstream
  sed -e '/ifdef SIGPIPE/,+2 d' \
    -e '/undef  FATAL_SIG/i FATAL_SIG (SIGPIPE);' \
    -i src/main.c

  ./configure --prefix=/usr \
    --without-guile \
    --host=$MIX_TGT \
    --build=$(build-aux/config.guess)
  make
  make DESTDIR=$PKG install
  rm -rv $PKG/usr/share/{info,man}
}
