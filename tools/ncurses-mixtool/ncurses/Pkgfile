# Description: libraries for handling of character screens

name=ncurses
version=6.3
release=0
source=(http://ftp.gnu.org/gnu/ncurses/ncurses-$version.tar.gz)

build() {
  cd $name-$version

  # ensure gawk is found
  sed -i s/mawk// configure

  mkdir -v build
  pushd build
    ../configure
    make -C include
    make -C progs tic
  popd

  ./configure --prefix=/usr \
    --host=$MIX_TGT \
    --build=$(./config.guess) \
    --mandir=/usr/share/man \
    --with-manpage-format=normal \
    --with-shared \
    --without-debug \
    --without-ada \
    --without-normal \
    --disable-stripping \
    --enable-widec
  make
  make DESTDIR=$PKG TIC_PATH=$(pwd)/build/progs/tic install

  install -d $PKG/lib

  # keep usr/lib as in lfs
  echo "INPUT(-lncursesw)" > $PKG/usr/lib/libncurses.so
  # crux move libraries to /lib
  #mv -v $PKG/usr/lib/libncursesw.so.6* $PKG/lib
  #ln -sfv ../../lib/libncursesw.so.$version $PKG/usr/lib/libncursesw.so
  rm -rv $PKG/usr/share/man
}
