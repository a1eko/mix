#!/bin/sh
#
# /etc/init.d/udev - udev start up script
#

case "${1}" in
    start | restart)
        if ! grep -q '[[:space:]]sysfs' /proc/mounts; then
            echo "error: sysfs not mount, cannot create devices"
            read -p "press Enter to shutdown the system..." ENTER
            /sbin/halt -d -f -i -p
        fi

        # no nead in hotplug binaries
        echo > /proc/sys/kernel/hotplug

        # start udev
        /sbin/udevd --daemon

        # traverse /sys in order to plug devices
        /sbin/udevadm trigger --action=add --type=subsystems
        /sbin/udevadm trigger --action=add --type=devices
        /sbin/udevadm trigger --action=change --type=devices

        # wait for udevd to process the triggered uevents 
        /sbin/udevadm settle
        ;;

    *)
        echo "Usage: ${0} {start}"
        exit 1
        ;;
esac

# End of file
